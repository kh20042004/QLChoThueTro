<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- ===================================
         TRANG HỒ SƠ CÁ NHÂN - QUẢN LÝ THÔNG TIN TÀI KHOẢN
         Cho phép người dùng xem/chỉnh sửa thông tin cá nhân, mật khẩu, địa chỉ
         Quản lý avatar, email, số điện thoại, xóa tài khoản
         =================================== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hồ Sơ Cá Nhân - HomeRent</title>
    
    <!-- ===== Thư viện CSS ===== -->
    <!-- Tailwind CSS - Framework CSS utility-first -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome - Icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts - Font chữ Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Choices.js - Searchable Select -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js@10.2.0/public/assets/styles/choices.min.css">
    <script src="https://cdn.jsdelivr.net/npm/choices.js@10.2.0/public/assets/scripts/choices.min.js"></script>
    
    <!-- CSS tùy chỉnh chung cho dự án -->
    <link rel="stylesheet" href="/css/main.css">
    
    <!-- ===== Cấu hình Tailwind CSS ===== -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    // Bảng màu tùy chỉnh
                    colors: {
                        primary: '#6B7280',    // Xám chính
                        secondary: '#9CA3AF',  // Xám phụ
                        accent: '#4B5563',     // Xám đậm
                        light: '#F9FAFB',      // Xám sáng
                        dark: '#1F2937'        // Xám đen
                    },
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif']  // Font chữ
                    }
                }
            }
        }
    </script>
    
    <!-- ===== Style tùy chỉnh và Animation ===== -->
    <style>
        body {
            font-family: 'Inter', sans-serif;  /* Font chữ mặc định */
        }
        
        /* ===== ANIMATION TÙY CHỈNH ===== */
        /* Animation: Trượt xuống với mờ dần - dùng cho dropdown */
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Class áp dụng animation slideDown */
        .animate-slideDown {
            animation: slideDown 0.3s ease-out;  /* Thời gian: 300ms */
        }
        
        /* ===== CHOICES.JS CUSTOM STYLING ===== */
        .choices__inner {
            border-radius: 0.5rem !important;
            border: 1px solid #D1D5DB !important;
            padding: 0.5rem 1rem !important;
            min-height: 42px !important;
            background-color: white !important;
        }
        
        .choices__inner:focus,
        .is-focused .choices__inner {
            border-color: #3B82F6 !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
        }
        
        .choices__list--dropdown {
            border-radius: 0.5rem !important;
            border: 1px solid #E5E7EB !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
            z-index: 1000 !important;
            max-height: 400px !important;
            overflow-y: auto !important;
            position: absolute !important;
        }
        
        .choices[data-type*="select-one"] .choices__list--dropdown {
            position: absolute !important;
        }
        
        .choices__list--dropdown .choices__list {
            max-height: 400px !important;
        }
        
        .choices__item--selectable {
            padding: 0.5rem 1rem !important;
        }
        
        .choices__item--selectable.is-highlighted {
            background-color: #EFF6FF !important;
            color: #1E40AF !important;
        }
        
        .choices__input {
            background-color: transparent !important;
            font-size: 0.875rem !important;
        }
        
        .choices__placeholder {
            opacity: 0.6 !important;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md shadow-sm">
        <nav class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <a href="/" class="flex items-center space-x-2 group">
                    <i class="fas fa-home text-2xl text-gray-600 group-hover:text-gray-800 transition-colors duration-300"></i>
                    <span class="text-xl font-bold text-gray-800">HomeRent</span>
                </a>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="/" class="text-gray-700 hover:text-gray-900 transition-colors duration-300 relative group">
                        Trang chủ
                        <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gray-800 group-hover:w-full transition-all duration-300"></span>
                    </a>
                    <a href="/properties" class="text-gray-700 hover:text-gray-900 transition-colors duration-300 relative group">
                        Tìm phòng
                        <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gray-800 group-hover:w-full transition-all duration-300"></span>
                    </a>
                    <a href="/universities" class="text-gray-700 hover:text-gray-900 transition-colors duration-300 relative group">
                        Trường ĐH
                        <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gray-800 group-hover:w-full transition-all duration-300"></span>
                    </a>
                    <a href="/about" class="text-gray-700 hover:text-gray-900 transition-colors duration-300 relative group">
                        Giới thiệu
                        <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gray-800 group-hover:w-full transition-all duration-300"></span>
                    </a>
                    <a href="/contact" class="text-gray-700 hover:text-gray-900 transition-colors duration-300 relative group">
                        Liên hệ
                        <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gray-800 group-hover:w-full transition-all duration-300"></span>
                    </a>
                </div>
                
                <!-- User Menu (Logged in) -->
                <div class="hidden md:flex items-center space-x-4" id="navbarUser">
                    <!-- Notifications -->
                    <a href="/notifications" class="relative p-2 text-gray-600 hover:text-gray-900 transition-colors duration-300">
                        <i class="fas fa-bell text-xl"></i>
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">3</span>
                    </a>
                    
                    <!-- Favorites -->
                    <a href="/favorites" class="relative p-2 text-gray-600 hover:text-gray-900 transition-colors duration-300">
                        <i class="fas fa-heart text-xl"></i>
                        <span id="favoriteBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">0</span>
                    </a>
                    
                    <!-- Chat/Messages -->
                    <button onclick="window.location.href='/chat'" class="relative p-2 text-gray-600 hover:text-gray-900 transition-colors duration-300" title="Tin nhắn">
                        <i class="fas fa-comments text-xl"></i>
                        <span id="chatBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">0</span>
                    </button>
                    
                    <!-- Post Property -->
                    <a href="/property/create" class="px-5 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-all duration-300 shadow-sm hover:shadow-md">
                        <i class="fas fa-plus mr-1"></i>Đăng tin
                    </a>
                    
                    <!-- User Dropdown -->
                    <div class="relative group">
                        <button class="flex items-center space-x-2">
                            <img src="https://via.placeholder.com/40/6B7280/ffffff?text=U" alt="Avatar" class="w-8 h-8 rounded-full border-2 border-gray-300" id="userAvatar">
                            <span class="text-gray-700" id="userName">Người dùng</span>
                            <i class="fas fa-chevron-down text-xs text-gray-500"></i>
                        </button>
                        
                        <div class="absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 animate-slideDown">
                            <div class="p-3 border-b border-gray-100">
                                <p class="text-sm text-gray-500" id="userEmail">user@example.com</p>
                            </div>
                            <a href="/profile" class="block px-4 py-2 text-gray-700 hover:bg-gray-50 transition-colors duration-200">
                                <i class="fas fa-user mr-2 text-gray-500"></i>Hồ sơ cá nhân
                            </a>
                            <a href="/my-properties" class="block px-4 py-2 text-gray-700 hover:bg-gray-50 transition-colors duration-200">
                                <i class="fas fa-home mr-2 text-gray-500"></i>Nhà/phòng của tôi
                            </a>
                            <a href="/recharge-history" class="block px-4 py-2 text-gray-700 hover:bg-gray-50 transition-colors duration-200">
                                <i class="fas fa-wallet mr-2 text-gray-500"></i>Lịch sử nạp tiền
                            </a>
                            <a href="/transaction-history" class="block px-4 py-2 text-gray-700 hover:bg-gray-50 transition-colors duration-200">
                                <i class="fas fa-exchange-alt mr-2 text-gray-500"></i>Lịch sử giao dịch
                            </a>
                            <div class="border-t border-gray-100"></div>
                            <a href="/logout" onclick="handleLogout(event)" class="block px-4 py-2 text-red-600 hover:bg-gray-50 transition-colors duration-200">
                                <i class="fas fa-sign-out-alt mr-2"></i>Đăng xuất
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Breadcrumb -->
    <div class="bg-white border-b border-gray-200 py-3 mb-6">
        <div class="container mx-auto px-4">
            <nav class="flex items-center gap-2 text-sm">
                <a href="/" class="text-gray-600 hover:text-blue-600">Trang chủ</a>
                <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
                <span class="text-gray-900 font-medium">Hồ sơ cá nhân</span>
            </nav>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 pb-12">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Sidebar -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg shadow-md p-6 sticky top-20">
                    <!-- Avatar -->
                    <div class="flex flex-col items-center mb-4">
                        <div class="relative inline-block mb-3">
                            <img id="avatarPreview" src="https://via.placeholder.com/120/0d6efd/ffffff?text=U" 
                                 alt="Avatar" class="w-28 h-28 rounded-full object-cover border-4 border-blue-100">
                            <label for="avatarInput" class="absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full cursor-pointer hover:bg-blue-700 transition-colors duration-150">
                                <i class="fas fa-camera text-sm"></i>
                            </label>
                            <input type="file" id="avatarInput" class="hidden" accept="image/*">
                        </div>
                        <h3 class="text-lg font-bold text-gray-900" id="profileName">Nguyễn Văn A</h3>
                        <p class="text-sm text-gray-600 mb-2" id="profileEmail">user@example.com</p>
                        <span class="inline-block px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium">
                            <i class="fas fa-check-circle mr-1"></i>Xác thực
                        </span>
                    </div>

                    <!-- Stats -->
                    <div class="grid grid-cols-3 gap-2 mb-6 py-4 border-y border-gray-200">
                        <div class="text-center">
                            <p class="text-lg font-bold text-gray-900">5</p>
                            <p class="text-xs text-gray-600">Tin đăng</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-gray-900">12</p>
                            <p class="text-xs text-gray-600">Yêu thích</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-gray-900">4.8</p>
                            <p class="text-xs text-gray-600">Đánh giá</p>
                        </div>
                    </div>

                    <!-- Menu -->
                    <div class="space-y-2">
                        <button class="w-full text-left px-4 py-3 rounded-lg bg-blue-50 text-blue-600 font-medium transition-colors duration-150 tab-btn active" data-tab="info">
                            <i class="fas fa-user mr-2"></i>Thông tin cơ bản
                        </button>
                        <button class="w-full text-left px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-150 tab-btn" data-tab="password">
                            <i class="fas fa-lock mr-2"></i>Đổi mật khẩu
                        </button>
                        <button class="w-full text-left px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-150 tab-btn" data-tab="address">
                            <i class="fas fa-map-marker-alt mr-2"></i>Địa chỉ
                        </button>
                        <button class="w-full text-left px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-150 tab-btn" data-tab="preferences">
                            <i class="fas fa-sliders-h mr-2"></i>Tùy chọn
                        </button>
                    </div>
                </div>
            </div>

            <!-- Main Panel -->
            <div class="lg:col-span-2">
                <!-- Thông tin cơ bản -->
                <div class="tab-content active" id="infoTab">
                    <div class="bg-white rounded-lg shadow-md overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
                            <h3 class="text-lg font-bold text-gray-900"><i class="fas fa-user mr-2 text-blue-600"></i>Thông tin cơ bản</h3>
                        </div>
                        <div class="p-6">
                            <form id="infoForm" class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="fullName" class="block text-sm font-medium text-gray-900 mb-1">Họ và tên <span class="text-red-500">*</span></label>
                                        <input type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="fullName" name="fullName" placeholder="Nguyễn Văn A" required>
                                    </div>
                                    <div>
                                        <label for="email" class="block text-sm font-medium text-gray-900 mb-1">Email <span class="text-red-500">*</span></label>
                                        <input type="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 cursor-not-allowed" id="email" name="email" placeholder="user@example.com" readonly>
                                        <p class="text-xs text-gray-600 mt-1">Email không thể thay đổi</p>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="phone" class="block text-sm font-medium text-gray-900 mb-1">Số điện thoại <span class="text-red-500">*</span></label>
                                        <input type="tel" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="phone" name="phone" placeholder="0987654321" required>
                                    </div>
                                    <div>
                                        <label for="dob" class="block text-sm font-medium text-gray-900 mb-1">Ngày sinh</label>
                                        <input type="date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="dob" name="dob">
                                    </div>
                                </div>

                                <div>
                                    <label for="bio" class="block text-sm font-medium text-gray-900 mb-1">Giới thiệu về bạn</label>
                                    <textarea class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="bio" name="bio" rows="3" placeholder="Viết vài dòng về bạn..."></textarea>
                                    <p class="text-xs text-gray-600 mt-1">Tối đa 500 ký tự</p>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="gender" class="block text-sm font-medium text-gray-900 mb-1">Giới tính</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="gender" name="gender">
                                            <option value="">-- Chọn giới tính --</option>
                                            <option value="male">Nam</option>
                                            <option value="female">Nữ</option>
                                            <option value="other">Khác</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-900 mb-1">Xác thực điện thoại</label>
                                        <div class="flex items-center gap-3">
                                            <!-- Trạng thái xác thực -->
                                            <div id="phoneVerificationStatus">
                                                <span class="inline-block px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm font-medium">
                                                    <i class="fas fa-times-circle mr-1"></i>Chưa xác thực
                                                </span>
                                            </div>
                                            <!-- Nút xác thực -->
                                            <button class="px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors duration-150 font-medium" type="button" id="verifyPhoneBtn">
                                                <i class="fas fa-shield-alt mr-1"></i>Xác thực ngay
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="flex gap-3 pt-4 border-t border-gray-200">
                                    <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-150 font-medium">
                                        <i class="fas fa-save mr-1"></i>Lưu thay đổi
                                    </button>
                                    <button type="reset" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-150 font-medium">
                                        <i class="fas fa-undo mr-1"></i>Hủy
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Đổi mật khẩu -->
                <div class="tab-content hidden" id="passwordTab">
                    <div class="bg-white rounded-lg shadow-md overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
                            <h3 class="text-lg font-bold text-gray-900"><i class="fas fa-lock mr-2 text-red-600"></i>Đổi mật khẩu</h3>
                        </div>
                        <div class="p-6">
                            <form id="passwordForm" class="space-y-4">
                                <div>
                                    <label for="currentPassword" class="block text-sm font-medium text-gray-900 mb-1">Mật khẩu hiện tại <span class="text-red-500">*</span></label>
                                    <div class="flex gap-2">
                                        <input type="password" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="currentPassword" name="currentPassword" required>
                                        <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-150 toggle-password" type="button">
                                            <i class="fas fa-eye text-gray-600"></i>
                                        </button>
                                    </div>
                                </div>

                                <div>
                                    <label for="newPassword" class="block text-sm font-medium text-gray-900 mb-1">Mật khẩu mới <span class="text-red-500">*</span></label>
                                    <div class="flex gap-2">
                                        <input type="password" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="newPassword" name="newPassword" 
                                               pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{8,}$" required>
                                        <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-150 toggle-password" type="button">
                                            <i class="fas fa-eye text-gray-600"></i>
                                        </button>
                                    </div>
                                    <p class="text-xs text-gray-600 mt-1">
                                        Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường và số
                                    </p>
                                </div>

                                <div>
                                    <label for="confirmPassword" class="block text-sm font-medium text-gray-900 mb-1">Xác nhận mật khẩu mới <span class="text-red-500">*</span></label>
                                    <div class="flex gap-2">
                                        <input type="password" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="confirmPassword" name="confirmPassword" required>
                                        <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-150 toggle-password" type="button">
                                            <i class="fas fa-eye text-gray-600"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="flex gap-3 pt-4 border-t border-gray-200">
                                    <button type="submit" class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-150 font-medium">
                                        <i class="fas fa-key mr-1"></i>Đổi mật khẩu
                                    </button>
                                    <button type="reset" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-150 font-medium">
                                        <i class="fas fa-undo mr-1"></i>Hủy
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Địa chỉ -->
                <div class="tab-content hidden" id="addressTab">
                    <div class="bg-white rounded-lg shadow-md overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
                            <h3 class="text-lg font-bold text-gray-900"><i class="fas fa-map-marker-alt mr-2 text-green-600"></i>Địa chỉ</h3>
                        </div>
                        <div class="p-6">
                            <form id="addressForm" class="space-y-4">
                                <div>
                                    <label for="street" class="block text-sm font-medium text-gray-900 mb-1">Địa chỉ chi tiết <span class="text-red-500">*</span></label>
                                    <input type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="street" name="street" placeholder="Số nhà, tên đường" required>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <label for="province" class="block text-sm font-medium text-gray-900 mb-1">
                                            Tỉnh/Thành phố <span class="text-red-500">*</span>
                                        </label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="province" name="province" required>
                                            <option value="">-- Chọn tỉnh/thành phố --</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">
                                            <i class="fas fa-info-circle mr-1"></i>Chọn tỉnh/thành phố
                                        </p>
                                    </div>
                                    <div>
                                        <label for="district" class="block text-sm font-medium text-gray-900 mb-1">
                                            Quận/Huyện <span class="text-red-500">*</span>
                                        </label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="district" name="district" required>
                                            <option value="">-- Chọn quận/huyện --</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">
                                            <i class="fas fa-info-circle mr-1"></i>Chọn tỉnh trước
                                        </p>
                                    </div>
                                    <div>
                                        <label for="ward" class="block text-sm font-medium text-gray-900 mb-1">
                                            Phường/Xã <span class="text-red-500">*</span>
                                        </label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors" id="ward" name="ward" required>
                                            <option value="">-- Chọn phường/xã --</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">
                                            <i class="fas fa-info-circle mr-1"></i>Chọn quận trước
                                        </p>
                                    </div>
                                </div>

                                <div class="flex gap-3 pt-4 border-t border-gray-200">
                                    <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-150 font-medium">
                                        <i class="fas fa-save mr-1"></i>Lưu thay đổi
                                    </button>
                                    <button type="reset" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-150 font-medium">
                                        <i class="fas fa-undo mr-1"></i>Hủy
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Tùy chọn -->
                <div class="tab-content hidden" id="preferencesTab">
                    <div class="bg-white rounded-lg shadow-md overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
                            <h3 class="text-lg font-bold text-gray-900"><i class="fas fa-sliders-h mr-2 text-cyan-600"></i>Tùy chọn</h3>
                        </div>
                        <div class="p-6">
                            <form id="preferencesForm" class="space-y-6">
                                <!-- Thông báo -->
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-3">Cài đặt thông báo</h4>
                                    
                                    <div class="flex items-center gap-3 mb-3">
                                        <input type="checkbox" id="notifyEmail" name="notifyEmail" checked class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500">
                                        <label for="notifyEmail" class="text-gray-700">Nhận thông báo qua email</label>
                                    </div>

                                    <div class="flex items-center gap-3 mb-3">
                                        <input type="checkbox" id="notifySMS" name="notifySMS" checked class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500">
                                        <label for="notifySMS" class="text-gray-700">Nhận thông báo qua SMS</label>
                                    </div>

                                    <div class="flex items-center gap-3">
                                        <input type="checkbox" id="notifyPush" name="notifyPush" checked class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500">
                                        <label for="notifyPush" class="text-gray-700">Nhận thông báo push</label>
                                    </div>
                                </div>

                                <div class="border-t border-gray-200"></div>

                                <!-- Quyền riêng tư -->
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-3">Quyền riêng tư</h4>
                                    
                                    <div class="flex items-center gap-3 mb-3">
                                        <input type="radio" id="privacyPublic" name="privacy" value="public" checked class="w-4 h-4 text-blue-600 border-gray-300 focus:ring-2 focus:ring-blue-500">
                                        <label for="privacyPublic" class="text-gray-700">Công khai - Mọi người có thể xem hồ sơ của tôi</label>
                                    </div>

                                    <div class="flex items-center gap-3">
                                        <input type="radio" id="privacyPrivate" name="privacy" value="private" class="w-4 h-4 text-blue-600 border-gray-300 focus:ring-2 focus:ring-blue-500">
                                        <label for="privacyPrivate" class="text-gray-700">Riêng tư - Chỉ bạn bè có thể xem hồ sơ của tôi</label>
                                    </div>
                                </div>

                                <div class="border-t border-gray-200"></div>

                                <!-- Các lựa chọn khác -->
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-3">Các lựa chọn khác</h4>
                                    
                                    <div class="flex items-center gap-3 mb-3">
                                        <input type="checkbox" id="twoFactor" name="twoFactor" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500">
                                        <label for="twoFactor" class="text-gray-700">Bật xác thực hai bước</label>
                                    </div>

                                    <div class="flex items-center gap-3">
                                        <input type="checkbox" id="newsletter" name="newsletter" checked class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500">
                                        <label for="newsletter" class="text-gray-700">Đăng ký nhận bản tin hàng tuần</label>
                                    </div>
                                </div>

                                <div class="flex gap-3 pt-4 border-t border-gray-200">
                                    <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-150 font-medium">
                                        <i class="fas fa-save mr-1"></i>Lưu tùy chọn
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Danger Zone -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden border-2 border-red-200 mt-6">
                    <div class="px-6 py-4 bg-red-50 border-b border-red-200">
                        <h3 class="text-lg font-bold text-red-700"><i class="fas fa-exclamation-triangle mr-2"></i>Vùng nguy hiểm</h3>
                    </div>
                    <div class="p-6">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-1">Xóa tài khoản vĩnh viễn</h4>
                                <p class="text-sm text-gray-600">Một khi bạn xóa tài khoản, không có cách nào để khôi phục dữ liệu của bạn.</p>
                            </div>
                            <button type="button" class="px-4 py-2 border-2 border-red-500 text-red-600 rounded-lg hover:bg-red-50 transition-colors duration-150 font-medium whitespace-nowrap" onclick="openDeleteModal()">
                                <i class="fas fa-trash mr-1"></i>Xóa tài khoản
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>


    <!-- Delete Account Modal -->
    <div id="deleteAccountModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50" style="display: none;">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200 bg-red-50">
                <h3 class="text-lg font-bold text-red-700">Xác nhận xóa tài khoản</h3>
            </div>
            <div class="p-6">
                <p class="text-red-600 font-bold mb-3">
                    <i class="fas fa-exclamation-circle mr-2"></i>Cảnh báo!
                </p>
                <p class="text-gray-700 mb-3">Bạn có chắc chắn muốn xóa tài khoản không? Hành động này sẽ:</p>
                <ul class="list-disc list-inside text-gray-600 text-sm mb-4 space-y-1">
                    <li>Xóa vĩnh viễn tất cả dữ liệu của bạn</li>
                    <li>Hủy tất cả các tin đăng của bạn</li>
                    <li>Hủy tất cả các đơn đặt phòng</li>
                    <li>Không thể khôi phục</li>
                </ul>
                <input type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent" id="confirmDeleteText" placeholder="Gõ 'XÓA TÀI KHOẢN' để xác nhận">
            </div>
            <div class="px-6 py-4 border-t border-gray-200 flex gap-3 justify-end">
                <button type="button" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-150 font-medium" onclick="closeDeleteModal()">
                    Hủy
                </button>
                <button type="button" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-150 font-medium disabled:opacity-50" id="confirmDeleteBtn" disabled>
                    <i class="fas fa-trash mr-1"></i>Xóa vĩnh viễn
                </button>
            </div>
        </div>
    </div>

            <!-- Footer -->
            <footer class="bg-gray-900/95 backdrop-blur-sm pt-12 pb-6 text-gray-300">
                <div class="container mx-auto px-4">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                        <div>
                            <h5 class="font-bold text-white mb-4 flex items-center">
                                <i class="fas fa-home mr-2"></i>HomeRent
                            </h5>
                            <p class="text-gray-400 mb-4">
                                Hệ thống cho thuê nhà/phòng trọ thông minh với công nghệ AI, giúp bạn tìm kiếm và quản lý bất động sản dễ dàng.
                            </p>
                            <div class="flex space-x-3">
                                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                                    <i class="fab fa-facebook text-xl"></i>
                                </a>
                                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                                    <i class="fab fa-twitter text-xl"></i>
                                </a>
                                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                                    <i class="fab fa-instagram text-xl"></i>
                                </a>
                                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                                    <i class="fab fa-youtube text-xl"></i>
                                </a>
                            </div>
                        </div>
                        
                        <div>
                            <h6 class="font-semibold text-white mb-4">Liên Kết</h6>
                            <ul class="space-y-2">
                                <li><a href="/" class="text-gray-400 hover:text-white transition-colors duration-300">Trang chủ</a></li>
                                <li><a href="/properties" class="text-gray-400 hover:text-white transition-colors duration-300">Tìm phòng</a></li>
                                <li><a href="/about" class="text-gray-400 hover:text-white transition-colors duration-300">Giới thiệu</a></li>
                                <li><a href="/contact" class="text-gray-400 hover:text-white transition-colors duration-300">Liên hệ</a></li>
                            </ul>
                        </div>
                        
                        <div>
                            <h6 class="font-semibold text-white mb-4">Hỗ Trợ</h6>
                            <ul class="space-y-2">
                                <li><a href="/faq" class="text-gray-400 hover:text-white transition-colors duration-300">Câu hỏi thường gặp</a></li>
                                <li><a href="/terms" class="text-gray-400 hover:text-white transition-colors duration-300">Điều khoản</a></li>
                                <li><a href="/privacy" class="text-gray-400 hover:text-white transition-colors duration-300">Bảo mật</a></li>
                                <li><a href="/guide" class="text-gray-400 hover:text-white transition-colors duration-300">Hướng dẫn</a></li>
                            </ul>
                        </div>
                        
                        <div>
                            <h6 class="font-semibold text-white mb-4">Liên Hệ</h6>
                            <ul class="space-y-2 text-gray-400">
                                <li>
                                    <i class="fas fa-map-marker-alt mr-2"></i>
                                    123 Đường ABC, Quận 1, TP.HCM
                                </li>
                                <li>
                                    <i class="fas fa-phone mr-2"></i>
                                    <a href="tel:0123456789" class="hover:text-white transition-colors duration-300">0123 456 789</a>
                                </li>
                                <li>
                                    <i class="fas fa-envelope mr-2"></i>
                                    <a href="mailto:info@homerent.vn" class="hover:text-white transition-colors duration-300">info@homerent.vn</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="border-t border-gray-700 pt-6 text-center text-gray-400">
                        <p class="mb-1">
                            &copy; 2024 HomeRent. All rights reserved. Developed with 
                            <i class="fas fa-heart text-red-500"></i> by Your Team
                        </p>
                        <small>Phiên bản 1.0.0</small>
                    </div>
                </div>
            </footer>

    <!-- Scripts -->
    <script src="/js/main.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/profile.js"></script>
    
    <!-- Tab Navigation -->
    <script>
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabName = this.getAttribute('data-tab');
                
                // Hide all tabs
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.add('hidden');
                });
                
                // Show selected tab
                document.getElementById(tabName + 'Tab').classList.remove('hidden');
                
                // Update button styles
                document.querySelectorAll('.tab-btn').forEach(b => {
                    b.classList.remove('bg-blue-50', 'text-blue-600', 'font-medium');
                    b.classList.add('text-gray-700', 'hover:bg-gray-100');
                });
                
                this.classList.add('bg-blue-50', 'text-blue-600', 'font-medium');
                this.classList.remove('text-gray-700', 'hover:bg-gray-100');
            });
        });
        
        // Toggle password visibility
        document.querySelectorAll('.toggle-password').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const input = this.parentElement.querySelector('input');
                const icon = this.querySelector('i');
                
                if (input.type === 'password') {
                    input.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    input.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        });
        
        // Delete modal functions
        function openDeleteModal() {
            document.getElementById('deleteAccountModal').style.display = 'flex';
        }
        
        function closeDeleteModal() {
            document.getElementById('deleteAccountModal').style.display = 'none';
            document.getElementById('confirmDeleteText').value = '';
            document.getElementById('confirmDeleteBtn').disabled = true;
        }
        
        // Enable delete button only when correct text is entered
        document.getElementById('confirmDeleteText').addEventListener('input', function() {
            document.getElementById('confirmDeleteBtn').disabled = this.value !== 'XÓA TÀI KHOẢN';
        });
        
        // Close modal when clicking outside
        document.getElementById('deleteAccountModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDeleteModal();
            }
        });
        
        // Dropdown toggle
        function toggleDropdown(e) {
            e.preventDefault();
            const dropdown = document.getElementById('userDropdown');
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
    const dropdown = document.getElementById('userDropdown');
    const btn = e.target.closest('[onclick="toggleDropdown(event)"]');

    if (dropdown && !btn && !dropdown.contains(e.target)) {
        dropdown.style.display = 'none';
    }
});
    </script>
    
    <!-- OTP Verification Modal -->
    <div id="otpModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full mx-4 transform transition-all">
            <!-- Header -->
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-shield-alt text-3xl text-blue-600"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Xác thực số điện thoại</h3>
                <p class="text-gray-600">Nhập mã OTP gồm 6 chữ số đã được gửi đến số điện thoại</p>
                <p class="text-blue-600 font-semibold mt-2" id="otpPhoneDisplay"></p>
            </div>

            <!-- OTP Input -->
            <div class="mb-6">
                <div class="flex gap-2 justify-center mb-4">
                    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center text-2xl font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all" data-index="0">
                    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center text-2xl font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all" data-index="1">
                    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center text-2xl font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all" data-index="2">
                    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center text-2xl font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all" data-index="3">
                    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center text-2xl font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all" data-index="4">
                    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center text-2xl font-bold border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all" data-index="5">
                </div>
                
                <!-- Error message -->
                <div id="otpError" class="hidden text-red-600 text-sm text-center mb-3">
                    <i class="fas fa-exclamation-circle mr-1"></i>
                    <span id="otpErrorMessage"></span>
                </div>

                <!-- Timer and Resend -->
                <div class="text-center text-sm">
                    <span class="text-gray-600">Mã có hiệu lực trong: </span>
                    <span id="otpTimer" class="font-semibold text-blue-600">10:00</span>
                </div>
                <div class="text-center mt-2">
                    <button id="resendOtpBtn" class="text-sm text-gray-500 hover:text-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        Gửi lại OTP (<span id="resendCountdown">60</span>s)
                    </button>
                </div>
            </div>

            <!-- Actions -->
            <div class="flex gap-3">
                <button id="cancelOtpBtn" class="flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium">
                    Hủy
                </button>
                <button id="verifyOtpBtn" class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    <span class="verify-btn-text">Xác thực</span>
                    <span class="verify-btn-loading hidden">
                        <i class="fas fa-spinner fa-spin mr-2"></i>Đang xác thực...
                    </span>
                </button>
            </div>

            <!-- Development Mode Notice -->
            <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm text-yellow-800 text-center">
                <i class="fas fa-info-circle mr-1"></i>
                <strong>Chế độ phát triển:</strong> Mã OTP sẽ hiển thị trong console
            </div>
        </div>
    </div>
    
    <!-- Favorites -->
    <script src="/js/favorites.js"></script>
    
    <!-- AI Chatbot Widget -->
    <link rel="stylesheet" href="/css/chatbot.css">
    <script src="/js/chatbot.js"></script>
</body>
</html>
